<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>2048 Wealth | Virtual Ventures</title>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; -webkit-tap-highlight-color: transparent; touch-action: none; }
        body, html { 
            height: 100dvh; width: 100vw; overflow: hidden !important; 
            background: #020617; color: white; font-family: 'Kanit', sans-serif; position: fixed;
        }

        .game-wrapper {
            display: flex; flex-direction: column; height: 100dvh; width: 100%;
            background-image: linear-gradient(to bottom, rgba(2, 6, 23, 0.5), rgba(2, 6, 23, 0.8)), url('jobs-bg.webp');
            background-size: cover; background-position: center;
            padding-top: 60px; align-items: center;
        }

        .ad-banner {
            width: 90%; height: 45px; background: rgba(15, 23, 42, 0.9);
            margin-bottom: 20px; border-radius: 12px; border: 1px solid rgba(251, 191, 36, 0.4);
            display: flex; align-items: center; justify-content: center;
            color: #fbbf24; font-size: 0.65rem; font-weight: 800; letter-spacing: 2px;
        }

        .stats-top { 
            display: flex; justify-content: space-between; width: 85%; 
            margin-bottom: 15px; color: #fff; font-size: 1rem; font-weight: 800;
        }

        /* PREMIUM GRID AREA */
        .grid-outer {
            padding: 12px; background: rgba(30, 41, 59, 0.5); 
            border-radius: 24px; border: 2px solid rgba(251, 191, 36, 0.3);
            box-shadow: 0 20px 50px rgba(0,0,0,0.5); backdrop-filter: blur(20px);
        }

        .grid-container {
            width: 300px; height: 300px; display: grid;
            grid-template-columns: repeat(4, 1fr); grid-template-rows: repeat(4, 1fr);
            gap: 12px;
        }

        .tile {
            width: 100%; height: 100%; background: rgba(255, 255, 255, 0.03);
            border-radius: 12px; display: flex; align-items: center; justify-content: center;
            font-size: 1.5rem; font-weight: 900; transition: all 0.1s ease;
            box-shadow: inset 0 0 10px rgba(255,255,255,0.02);
        }

        /* TILE PREMIUM COLORS */
        .tile-2 { background: #e2e8f0; color: #1e293b; }
        .tile-4 { background: #cbd5e1; color: #1e293b; }
        .tile-8 { background: #fb923c; color: white; box-shadow: 0 0 15px rgba(251, 146, 60, 0.3); }
        .tile-16 { background: #f97316; color: white; }
        .tile-32 { background: #ea580c; color: white; }
        .tile-64 { background: #dc2626; color: white; }
        
        /* MILESTONE TILES (GOLDEN LOOK) */
        .tile-128 { background: #eab308; color: white; box-shadow: 0 0 20px #eab308; font-size: 1.3rem; }
        .tile-256 { background: #facc15; color: #422006; box-shadow: 0 0 25px #facc15; border: 2px solid white; }
        .tile-512 { background: #fbbf24; color: #422006; box-shadow: 0 0 30px #fbbf24; }
        .tile-1024 { background: #f59e0b; color: white; box-shadow: 0 0 35px #f59e0b; font-size: 1.1rem; }
        .tile-2048 { background: linear-gradient(45deg, #fbbf24, #fff, #fbbf24); color: #000; box-shadow: 0 0 45px #fbbf24; font-size: 1.1rem; }

        .controls-hint { margin-top: 25px; color: #64748b; font-size: 0.7rem; font-weight: 700; text-align: center; }

        /* MODAL */
        .modal { position: fixed; inset: 0; background: rgba(2,6,23,0.96); display: none; align-items: center; justify-content: center; z-index: 1000; padding: 20px; }
        .modal-content { background: #1e293b; width: 100%; max-width: 320px; border-radius: 30px; border: 2px solid #fbbf24; padding: 30px; text-align: center; }
        .modal-btn { width: 100%; padding: 15px; border-radius: 15px; border: none; font-weight: 900; margin-top: 10px; cursor: pointer; }
    </style>
</head>
<body>

    <div class="game-wrapper">
        <div class="ad-banner">PREMIUM PARTNER AD</div>

        <div class="stats-top">
            <div>SCORE <br><span id="scoreText" style="color:#fbbf24">0</span></div>
            <div style="text-align:right">EARNED <br><span id="rewardText" style="color:#fbbf24">游리 0</span></div>
        </div>

        <div class="grid-outer">
            <div class="grid-container" id="grid"></div>
        </div>

        <div class="controls-hint">PC: USE ARROW KEYS<br>MOBILE: SWIPE TO MERGE</div>
    </div>

    <div class="modal" id="finishModal">
        <div class="modal-content">
            <div style="font-size: 3.5rem; margin-bottom: 10px;">游끥</div>
            <h2 style="font-weight: 900; letter-spacing: 1px; color: #fff;">WORK COMPLETE</h2>
            <p style="color: #94a3b8; font-size: 0.8rem; margin-bottom: 20px;">Market strategies analyzed. Profits calculated.</p>
            <div style="background: rgba(255,255,255,0.05); padding: 15px; border-radius: 20px; margin-bottom: 25px;">
                <span style="color: #94a3b8; font-size: 0.7rem;">TOTAL REWARD</span>
                <div id="finalRewardText" style="font-size: 2.2rem; font-weight: 900; color: #fbbf24;">游리 0</div>
            </div>
            <button class="modal-btn" style="background:#fbbf24; color:#020617;" onclick="location.href='jobs.html'">BACK TO JOBS</button>
            <button class="modal-btn" style="background:transparent; color:#94a3b8; border:1px solid #334155; margin-top:15px;" onclick="location.href='dashboard.html'">DASHBOARD</button>
        </div>
    </div>

    <script src="settings.js"></script>
    <script>
        let board = Array(16).fill(0);
        let score = 0;
        let earned = 0;
        let milestones = { 128: 50, 256: 100, 512: 200, 1024: 500, 2048: 1000 };
        let reached = [];

        function init() {
            const grid = document.getElementById('grid');
            grid.innerHTML = '';
            for(let i=0; i<16; i++) {
                let d = document.createElement('div');
                d.id = `t-${i}`; d.className = 'tile';
                grid.appendChild(d);
            }
            addTile(); addTile();
            updateUI();
        }

        function addTile() {
            let empty = board.map((v, i) => v === 0 ? i : null).filter(v => v !== null);
            if(empty.length) board[empty[Math.floor(Math.random()*empty.length)]] = Math.random()>0.1?2:4;
        }

        function updateUI() {
            board.forEach((val, i) => {
                let t = document.getElementById(`t-${i}`);
                t.innerText = val || '';
                t.className = `tile ${val ? 'tile-'+val : ''}`;
                if(milestones[val] && !reached.includes(val)) {
                    reached.push(val); earned += milestones[val];
                    document.getElementById('rewardText').innerText = `游리 ${earned}`;
                }
            });
            document.getElementById('scoreText').innerText = score;
            if (isGameOver()) setTimeout(finishGame, 1000);
        }

        function slide(row) {
            let arr = row.filter(v => v);
            for(let i=0; i<arr.length-1; i++) {
                if(arr[i] === arr[i+1]) { arr[i]*=2; score+=arr[i]; arr[i+1]=0; }
            }
            arr = arr.filter(v => v);
            while(arr.length < 4) arr.push(0);
            return arr;
        }

        function move(dir) {
            let old = [...board];
            for(let i=0; i<4; i++) {
                let row = [];
                if(dir==='L'||dir==='R') {
                    for(let j=0; j<4; j++) row.push(board[i*4+j]);
                    if(dir==='R') row.reverse();
                    let nr = slide(row);
                    if(dir==='R') nr.reverse();
                    for(let j=0; j<4; j++) board[i*4+j] = nr[j];
                } else {
                    for(let j=0; j<4; j++) row.push(board[j*4+i]);
                    if(dir==='D') row.reverse();
                    let nr = slide(row);
                    if(dir==='D') nr.reverse();
                    for(let j=0; j<4; j++) board[j*4+i] = nr[j];
                }
            }
            if(old.join() !== board.join()) { addTile(); updateUI(); }
        }

        // KEYBOARD CONTROLS FOR PC
        window.addEventListener('keydown', e => {
            if(e.key==='ArrowUp') move('U');
            if(e.key==='ArrowDown') move('D');
            if(e.key==='ArrowLeft') move('L');
            if(e.key==='ArrowRight') move('R');
        });

        // TOUCH CONTROLS
        let sx, sy;
        document.addEventListener('touchstart', e => { sx=e.touches[0].clientX; sy=e.touches[0].clientY; });
        document.addEventListener('touchend', e => {
            let dx = e.changedTouches[0].clientX - sx, dy = e.changedTouches[0].clientY - sy;
            if(Math.abs(dx) > Math.abs(dy)) { if(Math.abs(dx)>30) move(dx>0?'R':'L'); }
            else { if(Math.abs(dy)>30) move(dy>0?'D':'U'); }
        });

        function isGameOver() {
            if(board.includes(0)) return false;
            for(let i=0; i<4; i++) {
                for(let j=0; j<4; j++) {
                    if(j<3 && board[i*4+j] === board[i*4+j+1]) return false;
                    if(i<3 && board[i*4+j] === board[(i+1)*4+j]) return false;
                }
            }
            return true;
        }

        function finishGame() {
            let b = Number(localStorage.getItem('vv_balance')) || 0;
            localStorage.setItem('vv_balance', b + earned);
            document.getElementById('finalRewardText').innerText = "游리 " + earned;
            document.getElementById('finishModal').style.display = 'flex';
        }

        init();
    </script>
</body>
</html>