<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>2048 Wealth | Virtual Ventures</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Kanit', sans-serif; -webkit-tap-highlight-color: transparent; }
        body { background: #020617; color: #fff; height: 100dvh; display: flex; flex-direction: column; overflow: hidden; padding: 15px; }
        
        .gold-text { color: #fbbf24; }
        .royal-card { background: rgba(30, 41, 59, 0.8); backdrop-filter: blur(15px); border: 1px solid rgba(251, 191, 36, 0.2); }

        /* 2048 Grid Styling */
        #grid-container {
            width: 320px; height: 320px;
            background: #1e293b;
            border-radius: 15px;
            padding: 10px;
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            grid-template-rows: repeat(4, 1fr);
            gap: 10px;
            margin: 20px auto;
            position: relative;
            touch-action: none; /* Prevent scrolling while playing */
        }

        .tile {
            width: 100%; height: 100%;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            display: flex;
            align-items: center; justify-content: center;
            font-size: 1.2rem; font-weight: 900;
            transition: all 0.15s ease;
        }

        /* Tile Colors based on value */
        .tile-2 { background: #334155; color: #fff; }
        .tile-4 { background: #475569; color: #fff; }
        .tile-8 { background: #fbbf24; color: #000; box-shadow: 0 0 10px #fbbf24; }
        .tile-16 { background: #f59e0b; color: #000; }
        .tile-32 { background: #ea580c; color: #fff; }
        .tile-64 { background: #dc2626; color: #fff; }
        .tile-128 { background: #eab308; color: #000; font-size: 1rem; box-shadow: 0 0 15px #eab308; }
        .tile-256 { background: #facc15; color: #000; font-size: 1rem; }
        .tile-512 { background: #fbbf24; color: #000; }
        .tile-1024 { background: #fff; color: #000; font-size: 0.8rem; }
        .tile-2048 { background: #fbbf24; color: #000; box-shadow: 0 0 25px #fbbf24; animation: pulse 1s infinite; }

        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.05); } 100% { transform: scale(1); } }

        #endPopup { display: none; position: fixed; inset: 0; z-index: 1000; align-items: center; justify-content: center; background: rgba(0,0,0,0.9); backdrop-filter: blur(10px); }
    </style>
</head>
<body>

    <nav class="flex items-center justify-between mb-4">
        <button onclick="window.location.href='jobs.html'" class="text-white text-xl"><i class="fas fa-chevron-left"></i></button>
        <h1 class="text-lg font-black gold-text uppercase italic">2048 Wealth</h1>
        <div class="w-8"></div>
    </nav>

    <div class="flex justify-between items-center px-6 py-4 royal-card rounded-2xl mb-4">
        <div>
            <span class="text-[9px] text-gray-400 font-bold uppercase block">Current Value</span>
            <div class="flex items-center gap-1.5">
                <i class="fas fa-chart-line gold-text"></i>
                <span id="score" class="text-2xl font-black">0</span>
            </div>
        </div>
        <div class="text-right">
            <span class="text-[9px] text-gray-400 font-bold uppercase block">Target</span>
            <div class="text-xl font-black text-green-400">2048</div>
        </div>
    </div>

    <div id="grid-container">
        </div>

    <p class="text-center text-[10px] text-gray-500 uppercase font-bold tracking-widest">Swipe to Merge & Multiply Wealth</p>

    <div id="endPopup">
        <div class="w-full max-w-xs royal-card p-8 rounded-[2.5rem] text-center">
            <i class="fas fa-crown gold-text text-6xl mb-4"></i>
            <h2 id="resultTitle" class="text-2xl font-black uppercase text-white">Target Reached!</h2>
            <div class="my-6 bg-black/30 py-4 rounded-3xl border border-white/5">
                <p class="text-4xl font-black gold-text">ðŸŸ¡ 1,000</p>
                <p class="text-[10px] text-gray-500 uppercase mt-1">Winning Reward</p>
            </div>
            <div class="space-y-3">
                <button onclick="location.reload()" class="w-full py-4 rounded-xl font-black uppercase text-sm bg-yellow-400 text-black">Try Again</button>
                <button onclick="window.location.href='jobs.html'" class="w-full bg-white/5 text-white py-3 rounded-xl font-black uppercase text-xs border border-white/10">Back to Jobs</button>
            </div>
        </div>
    </div>

    <script src="settings.js"></script>
    <script>
        const gridContainer = document.getElementById('grid-container');
        const scoreDisplay = document.getElementById('score');
        let board = Array(16).fill(0);
        let score = 0;

        function initGame() {
            board = Array(16).fill(0);
            addTile();
            addTile();
            drawBoard();
        }

        function addTile() {
            let emptyTiles = board.map((val, idx) => val === 0 ? idx : null).filter(val => val !== null);
            if (emptyTiles.length > 0) {
                let randomIdx = emptyTiles[Math.floor(Math.random() * emptyTiles.length)];
                board[randomIdx] = Math.random() < 0.9 ? 2 : 4;
            }
        }

        function drawBoard() {
            gridContainer.innerHTML = '';
            board.forEach(value => {
                let tile = document.createElement('div');
                tile.className = `tile ${value ? 'tile-' + value : ''}`;
                tile.innerText = value ? value : '';
                gridContainer.appendChild(tile);
            });
            scoreDisplay.innerText = score;
            if (board.includes(2048)) endGame(true);
        }

        // --- Swipe Logic ---
        let touchStartX, touchStartY;
        document.addEventListener('touchstart', e => { touchStartX = e.touches[0].clientX; touchStartY = e.touches[0].clientY; });
        document.addEventListener('touchend', e => {
            let dx = e.changedTouches[0].clientX - touchStartX;
            let dy = e.changedTouches[0].clientY - touchStartY;
            if (Math.abs(dx) > Math.abs(dy)) {
                if (dx > 30) move('right'); else if (dx < -30) move('left');
            } else {
                if (dy > 30) move('down'); else if (dy < -30) move('up');
            }
        });

        function move(direction) {
            let oldBoard = [...board];
            if (direction === 'left') moveLeft();
            if (direction === 'right') moveRight();
            if (direction === 'up') moveUp();
            if (direction === 'down') moveDown();

            if (JSON.stringify(oldBoard) !== JSON.stringify(board)) {
                addTile();
                drawBoard();
                checkGameOver();
            }
        }

        function slide(row) {
            let arr = row.filter(val => val);
            for (let i = 0; i < arr.length - 1; i++) {
                if (arr[i] === arr[i + 1]) {
                    arr[i] *= 2;
                    score += arr[i];
                    arr.splice(i + 1, 1);
                }
            }
            while (arr.length < 4) arr.push(0);
            return arr;
        }

        function moveLeft() {
            for (let i = 0; i < 16; i += 4) {
                let row = board.slice(i, i + 4);
                board.splice(i, 4, ...slide(row));
            }
        }

        function moveRight() {
            for (let i = 0; i < 16; i += 4) {
                let row = board.slice(i, i + 4).reverse();
                board.splice(i, 4, ...slide(row).reverse());
            }
        }

        function moveUp() {
            for (let i = 0; i < 4; i++) {
                let col = [board[i], board[i+4], board[i+8], board[i+12]];
                let newCol = slide(col);
                for (let j = 0; j < 4; j++) board[i + j*4] = newCol[j];
            }
        }

        function moveDown() {
            for (let i = 0; i < 4; i++) {
                let col = [board[i], board[i+4], board[i+8], board[i+12]].reverse();
                let newCol = slide(col).reverse();
                for (let j = 0; j < 4; j++) board[i + j*4] = newCol[j];
            }
        }

        function checkGameOver() {
            if (!board.includes(0)) {
                // Simplified game over check
                alert("No more moves!");
            }
        }

        function endGame(win) {
            if (win) {
                let current = Number(localStorage.getItem('vv_coins')) || 0;
                localStorage.setItem('vv_coins', current + 1000);
                document.getElementById('endPopup').style.display = 'flex';
            }
        }

        initGame();
    </script>
</body>
</html>